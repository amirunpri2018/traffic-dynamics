---
title: "MÃ¼nster traffic data, *Shiny*"
author: "Thomas Kluth, Thorben Jensen"
date: "R Meetup 2018-06-11"
output:
  revealjs::revealjs_presentation:
    theme: blood
    center: true
# install.packages("revealjs")
# TODOs:
#   - use shiny PNG as background on title page 
---

# "I'm here<br>for the drinks.<br>What *is* Shiny, though?"

***
*"Shiny is an R package that makes it easy to<br>**build interactive web apps straight from R**<br>...<br>Shiny combines the computational **power of R**<br>with the **interactivity** of the modern web."*<br><br>- shiny.rstudio.com

## Shiny<br>= R<br>+ visualization<br>+ interaction {data-background="img/manhattan.jpg"}


# why we love Shiny<br><br><small>and why you should, too</small>

## R centered

- Get started with 20 lines of code
- Best web tool for R coders
- Well integrated with RStudio

## Quickly developed

- First app in 15 minutes
- Rapid prototyping
- No HTML, Javascript, PHP, Flash, ...

## Shiny

- Good looks by default
- Styleable with CSS
- Extendable (e.g. d3)


# how Shiny works

## Typical Workflow

1. Model & visualize, e.g. ```ggplot2```
2. Include in Shiny, including interactiveness
3. App done!

## Parts of shiny app

```
library(shiny)

...  # LOAD DATA
  
ui <- ...  # FRONTEND

server <- ...  # BACKEND

shinyApp(ui = ui, server = server)  # START APP
```

## Demo!

```https://github.com/ThorbenJensen/garage-shiny ```

## Part 1/4: load data

```
df_processed <-
  df %>%
  mutate(., free = as.numeric(free)) %>%
  mutate(., datetime = as_datetime(df$datetime,
                                   tz = "Europe/Berlin")) %>%
  mutate(., time = hms::as.hms(datetime))
```

## Part 2/4: frontend

```
ui <- fluidPage(

  titlePanel("Need a parking spot ?"),

  sidebarLayout(
    sidebarPanel(
      selectInput(inputId = "garage_name",
                  label = "Choose a car park:",
                  choices = unique(df_processed$name),
                  selected = "Parkhaus Karstadt")
    ),
    mainPanel(
      plotOutput(outputId = "time_series_plot")
    )
  ),
  theme = "custom.css"
)
```

## Part 3/4: CSS

```
@import url('https://fonts.googleapis.com/css?family=Satisfy');

.h2, h2 {
  font-size: 60px;
  font-family: 'Satisfy', courier;
  color: #f14559;
}

body {
  font-size: 20px;
}

.well {
  background-color: #f13a5994;
}
```


## Part 4/4: backend
```
server <- function(input, output) {

  output$time_series_plot <- renderPlot({

    df_processed %>%
      filter(., name == input$name) %>% 
      ggplot(data = ., aes(x = time, y = free)) +
      geom_line(aes(group = date), alpha = .3) +
      theme_bw() +
      xlab("Time of day") +
      ylab("Free spots") +
      ggtitle(paste0("Free parking spots per day for car park '",
                     input$garage_name, "'")) +
      theme(text = element_text(size = 20))
  })
}
```

# shiny in a Docker image

## Dockerfile

```
FROM rocker/shiny

# install necessary R packages
RUN install2.r --error dplyr lubridate RSQLite ggplot2

COPY ./src /srv/shiny-server/
```

## build and start Docker

```
sudo systemctl start docker
sudo docker build -t example-docker-app .
sudo docker run --rm -p 3838:3838 example-docker-app
```

# our project<br><br>Traffic Dynamics

## Why traffic data?

<!---
% - climate change is a global challenge
% - in Germany: traffic is responsible for roughly 18% of greenhouse gases
% - we might stop it on the local level
-->

- because of the climate change

temperature change | CO2 concentration
:------------------------|--------------------------:
![temperature change](img/temperature_change.png)|![CO2](img/CO2_concentration.png)



## traffic


temperature change | CO2 concentration
:------------------------|--------------------------:
![emissions](img/emmissions_traffic.png)|![kilometers](img/kilometers_kfz.png)


## Data source

- ...

## 

## Demo!

```http://traffics.codeformuenster.org```


# showdown:<br><br>bayesian vs frequentist<br>models in Shiny

## Our questions to the data

- ...

## How to include in Shiny

- ...

## Demo!

```http://traffics.codeformuenster.org```


# your turn:<br><br>what else to analyze?

## Our questions to you

- What would you like to know about traffic data?
- Any ideas for analyses/models?
- Do you know stakeholders to involve?


# our turn:<br><br>more questions?

# Acknowledgments

- TOOO

### image credits
- https://perspective-daily.de/article/391/SjcGXmvB
- https://www.umweltbundesamt.de/daten/verkehr/umweltbelastungen-durch-verkehr
